# Weekly Aggregator

Этот проект представляет собой Python-скрипт, который считает недельный агрегат на заданную дату и записывает результаты в соответствующий CSV файл.
Также добавил скрипт с использованием pyspark для оптимизации работы с csv, для дальнейшей интеграции в dag. Для работы скрипта необходимо установить локально, необходимо установленной библиотеки pyspark. 

## Установка и запуск script.py

1. Установите Python 3.x на вашем компьютере, если он еще не установлен.
2. Скачайте и распакуйте проект в папку на вашем компьютере.
3. Создайте папки input, output, intermediate
4. Откройте терминал или командную строку и перейдите в папку проекта.
5. Для генерации входных данных используется [скрипт](https://gist.github.com/afazulzyanov/c4cff39c216be63c10be27d39b0577d8)
6. Запустите скрипт командой ````python script.py YYYY-mm-dd````

## Установка и запуск pyspark_script.py
6. ````pip install pyspark````
7. Запустите скрипт командой ````python pyspark_script.py````
   !Данный скрипт генерирует файлы, исходя из текущей даты

## Функционал
При запуске скрипта происходит проверка на существование промежуточных агрегированных файлов за требуемый диапазон дней. Если файлы пропущены или не обнаружены производится их генерация, после чего скрипт обращается к уже агрегированным файлам и создаёт файл .csv с недельным агрегатом на требуемую дату. 
